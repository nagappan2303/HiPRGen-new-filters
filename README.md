This repository introduces additional filters for HiPRGen, focusing on more effective reaction filtering. The default star-count method in HiPRGen often fails because not all atoms in a reaction are unique. Ideally, HiPRGen should remove reactions that either involve the simultaneous breaking or forming of more than two bonds, or are break-1-form-1 reactions where the reaction center is not shared between the bond breaking and formation steps, as such reactions are unlikely to occur in a single concerted step.

To address this, we integrate the AAM-Ising repository, which performs fast and efficient atom-to-atom mapping for the main chain atoms (C, O, Na, S, etc., but excluding H). On top of this, we have added new functions in bond_breakage_1.py and bond_breakage_2.py to better implement the intended filtering in HiPRGen.

bond_breakage_1.py takes a reaction SMILES string (e.g., "C(=O)(OC[CH2])O[Na].C(=O)(OC[CH2])O[Na]>>C=C.O(C(=O)OCCOC(=O)O[Na])[Na]") and outputs the exact bonds broken and formed after performing atom-to-atom mapping. However, it does not track bond changes involving hydrogen atoms.

bond_breakage_2.py analyzes the molecules involved in the reaction by comparing the counts of each bond type (e.g., C–H, O–H, C–O, etc.) on the reactant and product sides, then reports the differences. This provides a way to track bonding changes involving hydrogen atoms. However, this approach is not fully robust — for example, if a hydrogen atom breaks from one carbon atom and attaches to another carbon atom within the same molecule, it would incorrectly report no net bond changes.
